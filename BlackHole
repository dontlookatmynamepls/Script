-- Load UI Library
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/bloodball/-back-ups-for-libs/main/wizard"))()

-- Window
local Window = Library:NewWindow("Flandre Hub")

-- Section
local Section = Window:NewSection("Black Hole Script")

-- === Config
getgenv().BlackHoleEnabled = false

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer

-- BlackHole Part Setup
local Folder = Instance.new("Folder", Workspace)
local Part = Instance.new("Part", Folder)
local Attachment1 = Instance.new("Attachment", Part)
Part.Anchored = true
Part.CanCollide = false
Part.Transparency = 1

-- State
local blackHoleActive = false
local followConnection
local addedConnection

-- === Force Part Except LocalPlayer
local function ForcePart(v)
    local char = LocalPlayer.Character
    if char and v:IsDescendantOf(char) then return end

    if v:IsA("Part") and not v.Anchored 
    and not v.Parent:FindFirstChild("Humanoid") 
    and not v.Parent:FindFirstChild("Head") 
    and v.Name ~= "Handle" then
        
        for _, x in ipairs(v:GetChildren()) do
            if x:IsA("BodyAngularVelocity") or x:IsA("BodyForce") or x:IsA("BodyGyro")
            or x:IsA("BodyPosition") or x:IsA("BodyThrust") or x:IsA("BodyVelocity")
            or x:IsA("RocketPropulsion") then
                x:Destroy()
            end
        end

        v.CanCollide = false
        local Torque = Instance.new("Torque", v)
        Torque.Torque = Vector3.new(100000, 100000, 100000)
        local AlignPosition = Instance.new("AlignPosition", v)
        local Attachment2 = Instance.new("Attachment", v)
        Torque.Attachment0 = Attachment2
        AlignPosition.MaxForce = 9e15
        AlignPosition.MaxVelocity = math.huge
        AlignPosition.Responsiveness = 200
        AlignPosition.Attachment0 = Attachment2
        AlignPosition.Attachment1 = Attachment1
    end
end

-- === Toggle Black Hole ===
local function toggleBlackHole(humanoidRootPart, state)
    blackHoleActive = state
    getgenv().BlackHoleEnabled = state

    if blackHoleActive then
        -- Force tất cả part hiện có
        for _, v in ipairs(Workspace:GetDescendants()) do
            ForcePart(v)
        end

        -- Force part mới spawn
        if addedConnection then addedConnection:Disconnect() end
        addedConnection = Workspace.DescendantAdded:Connect(function(v)
            if blackHoleActive then
                ForcePart(v)
            end
        end)

        -- Follow nhân vật
        if followConnection then followConnection:Disconnect() end
        followConnection = RunService.RenderStepped:Connect(function()
            if humanoidRootPart and humanoidRootPart.Parent then
                Attachment1.WorldCFrame = humanoidRootPart.CFrame
            end
        end)
    else
        if followConnection then followConnection:Disconnect() end
        if addedConnection then addedConnection:Disconnect() end
        followConnection, addedConnection = nil, nil
    end
end

-- === Respawn Handling ===
LocalPlayer.CharacterAdded:Connect(function(char)
    local humanoidRootPart = char:WaitForChild("HumanoidRootPart")
    if blackHoleActive then
        toggleBlackHole(humanoidRootPart, true)
    end
end)

Section:CreateButton("tiktok:@flandrescript", function()
    print("Credit: @flandrescript")
end)

Section:CreateButton("Skid = Gay", function()
    print("Credit: @flandrescript")
end)

Section:CreateToggle("Black Hole", function(value)
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local humanoidRootPart = char:WaitForChild("HumanoidRootPart")

    toggleBlackHole(humanoidRootPart, value) -- bật/tắt thực sự
    print("Black Hole state:", value)
end)
